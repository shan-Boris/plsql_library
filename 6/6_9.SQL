-- Вывести список неблагонадежных читателей (если больше 2х просрочек)

SELECT C.FIRST_NAME||' '||C.LAST_NAME||' '||C.FATHER_NAME AS CLIENT, 
    COUNT (C.FIRST_NAME||' '||C.LAST_NAME||' '||C.FATHER_NAME) AS НАРУШЕНИЯ
FROM LOG_DELIVERY_RETURN_BOOK DRB 
    JOIN CLIENT C 
        ON (C.ID = DRB.ID_CLIENT)
WHERE DRB.RETURN_BOOK IS NULL 
    AND ROUND(SYSDATE - DRB.TAKE_BOOK) > 14
    OR ROUND(DRB.RETURN_BOOK - DRB.TAKE_BOOK) > 14
GROUP BY C.FIRST_NAME||' '||C.LAST_NAME||' '||C.FATHER_NAME, RATING
HAVING COUNT (C.FIRST_NAME||' '||C.LAST_NAME||' '||C.FATHER_NAME) > 2;